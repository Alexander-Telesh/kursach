// Переключаем ночной/дневной режим
// function day_night_mode(e) {
//     if ($('body').hasClass('night_mode')){
//         $('body').removeClass('night_mode');
//         //$('#day_night_select').attr('data-original-title', 'Ночной режим').tooltip('fixTitle').tooltip('show').find('.fas').removeClass('fa-sun').addClass('fa-moon');
//         $('#day_night_select').find('.fas').removeClass('fa-sun').addClass('fa-moon');
//         $.cookie("nightMode", null, {path: '/'});
//     } else {
//         $('body').addClass('night_mode');
//         //$('#day_night_select').attr('data-original-title', 'Включить солнце').tooltip('fixTitle').tooltip('show').find('.fas').removeClass('fa-moon').addClass('fa-sun');
//         $('#day_night_select').find('.fas').removeClass('fa-moon').addClass('fa-sun');
//         $.cookie("nightMode", '1', {path: '/'});
//     }
// }

// // Кнопка вверх
// $(window).scroll(function(){
//     if ($(this).scrollTop() > 800) {
//         $('#scrollup').addClass('active');
//     } else {
//         $('#scrollup').removeClass('active');
//     }
// });

// function scroll_top_position(){
//     var left = ( $(window).width() - $('.box-page').width() ) / 2 + 30;
//     $('#scrollup').css('left', left);
// }

// //анимация прогресс-баров
// function progress(elem, max) {
//         var width = 1;
//         var id = setInterval(frame, 10);
//         function frame() {
//             if (width >= max) {
//                 clearInterval(id);
//             } else {
//                 width++; 
//                 elem.css('width', width + '%')
//             }
//         }
//     }
    
// $(document).ready(function() {
//     // tooltips on hover
//     $('[data-toggle=\'tooltip\']').tooltip({container: 'body',trigger: 'hover'});
//     $('.dropdown-toggle').dropdown();

//     //активируем прогресс-бары
//     $('.progress-bar').each(function( i ) {
//         var elem = $(this);
//         var max = $(this).data('max');
//         var now = $(this).data('now');
//         w = now * 100 / max;
//         progress(elem, w);
//     });
    

//     // Makes tooltips work on ajax generated content
//     $(document).ajaxStop(function() {
//         $('[data-toggle=\'tooltip\']').tooltip({container: 'body'});
//         $('.dropdown-toggle').dropdown();
//     });

//     // давим букашку
//     $('#shmyak').click(function () {
//         $('#shmyak').toggleClass('shmyak');
//     });

//     scroll_top_position();
//     $('#scrollup').click(function(){
//         $("html, body").animate({ scrollTop: 0 }, 400);
//         return false;
//     });


//     // закрытие вджетов в правом столбце
//     $(".right-block-title").click(function() {
//         $(this).parent().children('.right-block-body').slideToggle('normal');
//         $(this).parent().toggleClass('right-block-close');
//         var al = $.cookie("rightblocks") || "";
//         var wg = $(this).parent().attr("id");
//         if (al.indexOf(wg) > -1) {
//             al = al.replace(wg, '');
//         } else {
//             al = al + wg;
//         }
//         $.cookie("rightblocks", al, {path: '/'});  
//     });

//     // показываем основной поиск (mobile).
//     $('.mobile-search-icon').click(function () {
//         $('.header-search').addClass('active');
//         setTimeout(function() {
//             $('.header-search input.form-control').focus();
//         }, 200);
//     });

//     // скрываем основной поиск (mobile).
//     $('.close-search-mobile').click(function () {
//         $('.header-search').removeClass('active');
//     });


//     //показываем мобильное меню (mobile)
//     $('.mobile-menu-icon').click(function () {
//         $('body').addClass('modal-open').addClass('off-canvas');
//         if(navigator.userAgent.match(/(iPhone|iPod|iPad)/i)){
//             $('.page, html').addClass('modal-open');    
//         }
//         if ($('.mobile-menu-icon').hasClass('has-notice')){
//             $('.mobile-menu-tabs a[href=\'#mobile-tab-notice\']').trigger('click');
//         }
//         $('#mobile-menu-overlay, .mobile-menu-icon, .mobile-menu').addClass('active');
        
//             $height = $(".mobile-menu .tab-pane.fade.active").height()+55;
//             if ($('#mobile-tab-notice').hasClass('active')){
//                 $height += 30;
//             }
//             $("body").css('min-height', $height);
//     });

//     //скрываем мобильное меню (mobile)
//     $('.overlay').click(function () {
//         var menuOverlay = $('.overlay');
//         menuOverlay.removeClass('active');
//         $('body, .page, html').removeClass('modal-open');
//         $('.mobile-menu').removeClass('active');
//         $("body").removeClass('off-canvas');
//         $('.mobile-menu-icon').removeClass('active');
//         $('#mobile-menu-tab-link .fas').removeClass('fa-arrow-alt-from-right').addClass('fa-th');
//         resetBodyHeight();
//         resetMobileMenuUlHeight();
//     });

// });

// // фиксы для работы мобильного меню на IOS
// function resetBodyHeight() {
//     $("body").css('min-height', '0');    
// }
// function resetMobileMenuUlHeight() {
//     $('.main-menu-mobile > ul').css('min-height', '0');   
// }

// // debounce - константа, для снижения нагрузки при функции ресайза
// // под ней - считываем событие ресайза и отправляем в функцию, отвечающую за перенос
// // профиля и переписки внутрь меню
// // http://qaru.site/questions/16064/javascript-window-resize-event/117609#117609
// const debounce = (func, wait, immediate) => {
//     var timeout;
//     return () => {
//         const context = this;
//         const later = function() {
//             timeout = null;
//             if (!immediate) func.apply(context);
//         };
//         const callNow = immediate && !timeout;
//         clearTimeout(timeout);
//         timeout = setTimeout(later, wait);
//         if (callNow) func.apply(context);
//     };
// };

// window.addEventListener('resize', debounce(() => moveInfoToMobileMenu(), 50, false), false);
// window.addEventListener('resize', debounce(() => scroll_top_position(), 0, false), false);
// window.addEventListener('orientationchange', () => moveInfoToMobileMenu(), false);

// function moveInfoToMobileMenu() {

//     var $userInfo = $('.header-user');
//     var $userMenu = $('.user-menu');
//     var $userMenuTop = $('.user-menu-top');
    
//     var $userInfoMobile = $('.mobile-user');
//     var $userMenuMobile = $('.mobile-user-menu');
//     var $userMenuTopMobile = $('.mobile-user-menu-top');

//     var $userNotice = $('#right-block-notice .right-block-body');
//     var $userNoticeMobile = $('#mobile-tab-notice');

//     var $mainMenu = $('.left-sidebar .left-block-menu');
//     var $mainMenuMobile = $('#mobile-tab-menu .main-menu-mobile');
    
//     if (document.body.clientWidth <= '1199') {
//        if ($('.mobile-menu').hasClass('full')){
//         return false;
//         } else {    
//             $userInfoMobile.html($userInfo.html()); //перемещаем инфу о профиле
//             $userMenuMobile.html($userMenu.html()); //перемещаем меню пользователя
//             $userMenuTopMobile.html($userMenuTop.html()); //перемещаем верхнее меню пользователя
//             $userNoticeMobile.html($userNotice.html()); //перемещаем уведомления
//             $mainMenuMobile.html($mainMenu.html()); //перемещаем главное меню
            
//             //фиксим всплывающие тултипы - обновляем все и убираем ДР
//             $('.mobile-menu a[data-placement=left], .mobile-menu div[data-placement=left]').attr('data-toggle', '');
//             $('[data-toggle=\'tooltip\']').tooltip({container: 'body'});

//             //очищаем старых родителей и добавляем класс завершения переноса
//             $('.header-user, .user-menu, .user-menu-top, #right-block-notice .right-block-body, .left-sidebar .left-block-menu').html('');
//             $('.main-menu-level-1').removeClass('show_lvl_2');
//             $('.left-sidebar').removeClass('has_overlay');
//             $('.mobile-menu').addClass('full');
//         }
//     }  else {
//        if ($('.mobile-menu').hasClass('full')){

//             $userInfo.html($userInfoMobile.html()); //перемещаем инфу о профиле
//             $userMenu.html($userMenuMobile.html()); //перемещаем меню пользователя
//             $userMenuTop.html($userMenuTopMobile.html()); //перемещаем верхнее меню пользователя
//             $userNotice.html($userNoticeMobile.html()); //перемещаем уведомления
//             $mainMenu.html($mainMenuMobile.html()); //перемещаем главное меню

//             //фиксим всплывающие тултипы - обновляем все и убираем ДР
//             $('#right-block-notice a[data-placement=left], #right-block-notice div[data-placement=left]').attr('data-toggle', 'tooltip');
//             $('[data-toggle=\'tooltip\']').tooltip({container: 'body'});
            
//             //очищаем старых родителей и добавляем класс завершения переноса
//             $('.mobile-user, .mobile-user-menu, .mobile-user-menu-top, #mobile-tab-notice, #mobile-tab-menu .main-menu-mobile').html('');
//             $('body, .page, html').removeClass('modal-open');
//             $('.main-menu-level-1').removeClass('show_lvl_2');
//             $('.mobile-menu').removeClass('full');
//         } else {
//             return false;
            
//         }
//     } 
// }

$(document).ready(function() {
    // если разрешение меньше или равно 1199 при загрузке страницы- переносим в мобилку
    // if (document.body.clientWidth <= '1199') {
    //     moveInfoToMobileMenu();
    // }

    // доп фишки для мобильного меню
    $('.left-block-menu').on('mousemove', '.main-menu-level-1', function(e){ 
      var mw = 207;
      var container_left = 207*level2_width/100 + (level2_width<100?35:0);
      $('.main-menu-level-2-container').css('left', container_left+'px')
      if (e.offsetX < 207*level2_width/100 && level2_width > 0) {
        if ($( window ).width() < 769) {
            return;
        }
        $('.left-block-menu').addClass('has_overlay');
        // $('#_fade').addClass('_fade');
        $(this).addClass('show_lvl_2');
        $(".portfolio").hide(); // польз. меню конфликтует с боковым, если открыто, всегда закрываем его
      }
    });

    $('.left-block-menu').on('mouseleave', '.main-menu-level-1', function(e){ 
        if ($( window ).width() < 769) {
            return;
        }
        $('.left-block-menu').removeClass('has_overlay');
        // $('#_fade').removeClass('_fade');
        $(this).removeClass('show_lvl_2');
    });
    

    // $('.main-menu-mobile').on('click', '.main-menu-level-1 a', function(e){ 
    //     if ($(this).parent().children('.main-menu-level-2-container').length > 0) {
    //         e.preventDefault();
    //         $('.main-menu-level-1').removeClass('show_lvl_2');
    //         $(this).parent().addClass('show_lvl_2');
    //         $('#mobile-menu-tab-link .fas').removeClass('fa-th').addClass('fa-arrow-alt-from-right');

    //         $height = $(this).next(".main-menu-level-2-container").find('> div').height()+30;
    //         $(this).parent().parent().css('min-height', $height);
    //      } 
    // });

    // $('.mobile-menu-tabs').on('click', '#mobile-menu-tab-link', function(){ 
    //     $('.main-menu-mobile .main-menu-level-1').removeClass('show_lvl_2');
    //     $('#mobile-menu-tab-link .fas').removeClass('fa-arrow-alt-from-right').addClass('fa-th');
    // });

    // $('.mobile-menu-tabs').on('click', 'a', function(){ 
    //     resetMobileMenuUlHeight();
    //     setTimeout(function() {
    //         $height = $(".mobile-menu .tab-pane.fade.active").height()+55;
    //         if ($('#mobile-tab-notice').hasClass('active')){
    //             $height += 30;
    //         }
    //         $("body").css('min-height', $height);
    //     }, 200);
    // });
});


// Добавляем поддержку свайпов для закрытия мобильного меню

// document.addEventListener('touchstart', handleTouchStart, false);
// document.addEventListener('touchmove', handleTouchMove, false);

// var xDown = null;
// var yDown = null;

// function handleTouchStart(evt) {
//     xDown = evt.touches[0].clientX;
//     yDown = evt.touches[0].clientY;
// };

// function handleTouchMove(evt) {
//     if ( ! xDown || ! yDown ) {
//         return;
//     }

//     var xUp = evt.touches[0].clientX;
//     var yUp = evt.touches[0].clientY;

//     var xDiff = xDown - xUp;
//     var yDiff = yDown - yUp;


//     if ( Math.abs( xDiff ) > Math.abs( yDiff ) ) {
//         if ( xDiff > 0 ) {
//         /* left swipe */

//         if ($('#mobile-menu-overlay').is(':visible')) {
//             if ($('.main-menu-level-1').hasClass('show_lvl_2')) {
//                 $('#mobile-menu-tab-link').trigger('click');
//             } else {
//                 $('#mobile-menu-overlay').trigger('click');      
//             }         
//         }

//         } else {
//             if ( xDown < 45 ) {
//              /*   if ($('.mobile-menu-icon').hasClass('active')){ 
                
//                 } else{
//                     $('.mobile-menu-icon').trigger('click');
//                 } */
//             }
//             /* right swipe */
//         }
//     } else {
//         if ( yDiff > 0 ) {
//         /* up swipe */

//         } else {
//             /* down swipe */
//         }
//     }
//     /* reset values */
//     xDown = null;
//     yDown = null;
// };
// $(document).on(
//     'click.bs.dropdown.data-api', 
//     '.noclose',
//     function (e) { e.stopPropagation() }
// );

// /****************************************************************************
// standart.js
// ****************************************************************************/
// function addbookmark()
// {
//   window.external.AddFavorite("http://fantlab.ru","FantLab.ru - Лаборатория Фантастики")
// }
// function setCookie(cookieName, cookieContent, cookieExpireTime)
// {
//     if(cookieExpireTime>0)
//     {
//     var d=new Date();
//     d.setDate(d.getDate()+cookieExpireTime);
//         document.cookie=cookieName+"="+cookieContent+"; path="+escape('/')+"; expires="+d.toGMTString();
//     }else
//     {
//         document.cookie=cookieName+"="+cookieContent+"; path="+escape('/')+"";
//     }
// }

// function getCookie(cookieName)
// {
//   if(!cookieName)
//   {
//     return false;
//   };
//   var cookieArray = document.cookie.split('; ');
//   for(var i = 0; i < cookieArray.length; i++)
//   {
//     var name_valueCookie = cookieArray[i].split('=');
//     if(name_valueCookie[0] == cookieName)
//     {
//       return unescape(name_valueCookie[1]);
//     };
//   };
//   return false;
// };


// function escapeEx(str)
// {
//     var ret = '';
//     return str;

//     for (i=0; i<str.length; i++)
//     {
//         var n = str.charCodeAt(i);
//         if (n >= 0x410 && n <= 0x44F)
//           n -= 0x350;
//         else if (n == 0x451)
//           n = 0xB8;
//         else if (n == 0x401)
//           n = 0xA8;
//         if ((n < 65 || n > 90) && (n < 97 || n > 122) && n < 256)
//         {
//           if (n < 16)
//             ret += '%0'+n.toString(16);
//           else
//             ret += '%'+n.toString(16);
//         }
//         else
//         ret += String.fromCharCode(n);
//     }
//     return ret;
// }                                                                                       

// function getXmlHttp()
// {
//   var xmlhttp;
//   try { xmlhttp = new ActiveXObject("Msxml2.XMLHTTP"); }
//   catch (e)
//   {
//     try { xmlhttp = new ActiveXObject("Microsoft.XMLHTTP"); }
//     catch (E) { xmlhttp = false; }
//   }
//   if (!xmlhttp && typeof XMLHttpRequest!='undefined')
//   {
//     xmlhttp = new XMLHttpRequest();
//   }
//   return xmlhttp;
// }

// /****************************************************************************
// авторизация-регистрация
// ****************************************************************************/
// $(document).ready(function() {
//     //показать пароль
//     $('body').on('click', '.show-password', function(){
//         if($(this).hasClass('active')){
//             $(this).prev('input').attr('type','password');
//             $(this).removeClass('active').find('.fa-eye-slash').removeClass('fa-eye-slash').addClass('fa-eye');
//         } else {
//             $(this).prev('input').attr('type','text');
//             $(this).addClass('active').find('.fa-eye').removeClass('fa-eye').addClass('fa-eye-slash');
//         }
//     });

//     // показ и скрытие подсказки при фокусировке в поле
//     $('body').on('focusin', '.has-help input, .has-help textarea', function(){
//         $(this).next('.help').tooltip('show');
//     });
//     $('body').on('focusout', '.has-help input, .has-help textarea', function(){
//         $(this).next('.help').tooltip('hide');
//     });

// });

// //выставление ошибок (только для форм по стандарту)
// function set_error(input){
//     $(input).closest('.form-group').removeClass('success').addClass('error');
// }
// function set_error_max(input){
//     $(input).closest('.form-group').removeClass('success').addClass('error error-max');
// }
// function set_success(input){
//     $(input).closest('.form-group').removeClass('error').removeClass('error-max').addClass('success');
// }


// function check_login(login,full_check = false) {
//     var input = 'input[name=\'log\']';
//     //убираем пробелы в начале и в конце
//     //заменяем несколько подряд идущих пробелов одним
//     login = login.replace(/(^\s+|\s+$)/g, '').replace(/\s\s+/g, ' ', ' ');
    
//     // изменённый логин подставляем в поле ввода
//     $(input).val(login);

//     // если в логине недопустимое количество символов - уведомим об этом и прервём проверку
//     if ( (login.length < 2) || (login.length > 16) ) {
//         if (full_check){
//             new Noty({type: 'error', timeout: 4000, text: 'Логин должен содержать не менее 2 и не более 16 символов!'}).show();
//             set_error_max(input);
//         } else {
//             set_error(input);
//         }
//         return false;
//     }
    
//     // если содержатся недопустимые символы - уведомим и прервём проверку
//     if (/[^a-zA-Z0-9А-я\-\_\.\ ]/.test(login)){
//         if (full_check){
//             new Noty({type: 'error',timeout: 4000,text: 'Логин может содержать только буквы, цифры, символы "_" "-" "." и символ пробела.',}).show();
//             set_error_max(input);
//         } else {
//             set_error(input);
//         }
//         return false;
//     }
//     // проверяем занятость логина
//     $.ajax({
//         url: '/userlogin?usersearch='+login + '&tmp=' + Math.random(),
//         type: 'get',
//         dataType: 'json',
//         beforeSend: function() {
            
//         },
//         complete: function() {

//         },
//         success: function(data) {
//             if(data['user_id'] == 0){
//                 set_success(input);
//             } else {
//                 if (full_check){
//                     new Noty({type: 'error', timeout: 4000, text: 'К сожалению данный Логин занят <i class="far fa-frown"></i>'}).show();
//                     set_error_max(input);
//                 } else {
//                     set_error(input);
//                 }
//             }
            
//         },
//         error: function(xhr, ajaxOptions, thrownError) {
//             alert("Ошибка");
//         }
//     });  
// }

// function check_pass(pass,full_check = false) {
//     var input = 'input[name=\'pas1\']';
//     var input2 = 'input[name=\'pas2\']';

//     // если в логине недопустимое количество символов - уведомим об этом и прервём проверку
    
//     if ($(input).val() != pass) {
//         if (full_check){
//             new Noty({type: 'error', timeout: 4000, text: 'Введённые пароли не совпадают'}).show();
//             set_error_max(input2);
//         } else {
//             set_error(input2);
//         }
//     } else {
//         if ($(input).val() != '') {
//             set_success(input);
//             set_success(input2);
//         }
//     }
// }
// function check_pass2(pass,full_check = false) {
//     var input = 'input[name=\'pas1\']';
//     var input2 = 'input[name=\'pas2\']';

//     if ( ($(input2).val() == pass) && ($(input).val() != '')){
//         set_success(input);
//         set_success(input2);
//     }   
// }
// function scrollPageToCl(cl) {
//     var to = $('.'+cl).offset().top - 30;
//     $("html, body").animate({scrollTop: to}, 500);
// }

// /****************************************************************************
// дополнение в поиске
// ****************************************************************************/
// $(document).mouseup(function (e){ 
//     var searchblock = $(".header-search form");
//     if (!searchblock.is(e.target) && searchblock.has(e.target).length === 0) { 
//         $('#mainsearch').parent().removeClass('open');
//     }       
// });

// var delay = (function(){
//     var timer = 0;
//     return function (callback, ms){
//         clearTimeout (timer);
//         timer = setTimeout(callback, ms);
//     };
// })();
// $(document).ready(function() {
//     $('.header-search').on('keyup', '#mainsearch', function(){
//         var result = '';
//         var query = $(this).val();
//         //убираем пробелы в начале и в конце
//         //заменяем несколько подряд идущих пробелов одним
//         query = query.replace(/(^\s+|\s+$)/g, '').replace(/\s\s+/g, ' ', ' ');

//         delay(function(){
//             //количество выводимых результатов
//             var search_results_count = 6;
//             $('#mainsearch').next('.dropdown-menu').html('');
           
//             if(query.length > 2){
//                 $.ajax({
//                     url: 'https://api.fantlab.ru/searchmain?q=' + query,// + '&onlymatches=1&type=analogs',
//                     type: 'get',
//                     dataType: 'json',
//                     success: function(data) {
//                         if(data){
//                             //console.log('-------');
//                             $(data).each(function( i ) {

//                                 //выводим авторов
//                                 if ( (this['type'] == 'autors') && (this['total'] > 0)){
//                                     i = 0;
//                                     $(this['matches']).each(function( j ) {
//                                         //проверка на наличие поискового запроса в имени. иначе - показать псевдоним
//                                         //прибавляем счетчик внутри так как поиск на бэке ищет не точные совпадения, и на ввод "Иванов" отдаст "Иван"
//                                         if (this['rusname'].toLowerCase().indexOf(query.toLowerCase()) > -1) {
//                                             i < 1 ? result += '<div class="dropdown-header">Авторы</div>' : '';
//                                             i < search_results_count ? result += '<a class="dropdown-item" href="/autor' + this['autor_id'] + '" ><span class="search-author-name">' + this['rusname'] + '</span></a>' : '';
//                                             i++;
//                                         } else {
//                                             if (this['pseudo_names'].toLowerCase().indexOf(query.toLowerCase()) > -1) {
//                                                 i < 1 ? result += '<div class="dropdown-header">Авторы</div>' : '';
//                                                 i < search_results_count ? result += '<a class="dropdown-item" href="/autor' + this['autor_id'] + '" ><span class="search-author-name">' + this['rusname'] + '</span><span class="search-author-pseudoname">псевдонимы: ' + this['pseudo_names'] + '</span></a>' : '';
//                                                 i++;
//                                             }
//                                         }
                                        
//                                     });
                                        
//                                 }

//                                 //выводим произведения
//                                 if ( (this['type'] == 'works') && (this['total'] > 0)){
//                                     i = 0;
//                                     $(this['matches']).each(function( j ) {
//                                         if (this['rusname'].toLowerCase().indexOf(query.toLowerCase()) > -1) {
//                                             i < 1 ? result += '<div class="dropdown-header">Произведения</div>' : '';
//                                             //оказывается год сть не везде
//                                             this['year'] != 0 ? year = this['year'] + ' г.' : year = '';
//                                             i < search_results_count ? result += '<a class="dropdown-item" href="/work' + this['work_id'] + '" ><span class="search-work-author-name">' + this['all_autor_rusname'] + '</span> <span class="search-work-name">' + this['rusname'] + ' <span class="search-work-type">' + this['name_show_im'] + '</span></span><span class="search-work-year">' + year + '</span></a>' : '';
//                                             i++;
//                                         }
//                                     });
//                                 }

//                               });
//                         }
//                         result += '<div class="ml-5 mr-5 mt-5"><a class="btn btn-primary btn-block" href="/searchmain?searchstr=' + query + '"><i class="far fa-search mr-5"></i>Все результаты по запросу «' + query + '»</a></div>';
//                         $('#mainsearch').next('.dropdown-menu').html(result);
//                         $('#mainsearch').parent().addClass('open');
//                     }
//                 });
//             } else {
//                 $('#mainsearch').parent().removeClass('open');
//             }
//         }, 300);
//     });
// });


// /****************************************************************************
// Страница юзера
// ****************************************************************************/
// function fixSlideMobile() {
//     if (document.body.clientWidth <= '767') {      
//         $('.user-page').addClass('visible');
//         setTimeout(function() {
//             $('.is-closed .user-page__card-body').css('display', 'none');    
//         }, 10);
//     }
// };
// window.addEventListener('resize', debounce(() => fixSlideMobile(), 0, false), false);
// window.addEventListener('orientationchange', () => fixSlideMobile(), false);

// $(document).ready(function() {
    
//     $('.card:not(.is-closed) .user-page__card-title').find('.fa-plus-circle').removeClass('fa-plus-circle text-primary').addClass('fa-minus-circle text-muted');
//     $('.card:not(.is-closed) .user-page__card-body').addClass('active');
//     fixSlideMobile();
//     $('.user-page__card-title').click(function(e){
//         e.stopPropagation(); 
//         if (document.body.clientWidth <= '767') {
//             var title = $(this);
//             var body = $(this).next('.user-page__card-body');
//             if ($(body).hasClass('active')){
//                 $(title).find('.fa-minus-circle').removeClass('fa-minus-circle text-muted').addClass('fa-plus-circle text-primary');
//                 $(body).removeClass('active').slideUp();
//             } else {
//                 $(title).find('.fa-plus-circle').removeClass('fa-plus-circle text-primary').addClass('fa-minus-circle text-muted');
//                 $(body).addClass('active').slideDown();
//                 $(body).parent().removeClass('is-closed');
//             }
//         }
        
//         var al = $.cookie("userblock") || "";
//         var wg = $(this).parent().attr("id");
//         if (al.indexOf(wg) > -1) {
//             al = al.replace(wg, '');
//         } else {
//             al = al + wg;
//         }
//         $.cookie("userblock", al, {path: '/'});
//     });

//     $('.dropdown-menu.dropdown-no-close').on('click', function(event){
//         event.stopPropagation();
//     });

//     $(".file-upload input[type=file]").change(function(){
//         var filename = $(this).val().replace(/.*\\/, "");
//         if (filename){
//             $(".file-upload .btn span").html(filename);
//             $(".file-upload .btn .far").removeClass('far fa-paperclip').addClass('fas fa-check text-success');
//         } else {
//             $(".file-upload .btn span").html('');
//             $(".file-upload .btn .fas").removeClass('text-success fas fa-check').addClass('far fa-paperclip');
//         } 
//     });
    
// });


// /****************************************************************************
// Страница издания
// ****************************************************************************/
// $(document).ready(function() {
//     $("[data-covers]").fancybox({
//         hash: false
//     });
// });

// /****************************************************************************
// Страница автора
// ****************************************************************************/
// // настройки отображения списка для мобильных
// $(document).ready(function() {
//     $(".worklist_mobile_settings [data-setting]").change(function(){
//         var $container = $('.worklist_mobile_settings_show');
//         var $class = $(this).data('class');
//         if ($container.hasClass($class)){
//             $.cookie($class, null, {path: '/'});
//         } else {
//             $.cookie($class, '1', {path: '/'});    
//         }
//         $container.toggleClass($class);
//     });
// });    

// функция для обработки кликов по пунктов пользовательского меню, чтобы кликая по любой части строки активировалась внутренняя ссылка
function handleClick(event) {
  const link = event.currentTarget.querySelector('a').href;
  if (event.button === 1) {  // клик средней кнопкой
      window.open(link, '_blank');
  } else if (event.button === 0) { // клик левой кнопкой
      window.location.href = link;
  }
}